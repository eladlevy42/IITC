<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div class="main">
      <div class="boardWrapper">
        <div class="top">
          <label id="mistakes"></label>
          <label id="moves"></label>
        </div>
        <div id="board">
          <div class="card" id="card1">
            <button class="square" id="s1" onclick="revealPic(1)"></button>
          </div>
          <div class="card" id="card2">
            <button class="square" id="s2" onclick="revealPic(2)"></button>
          </div>
          <div class="card" id="card3">
            <button class="square" id="s3" onclick="revealPic(3)"></button>
          </div>
          <div class="card" id="card4">
            <button class="square" id="s4" onclick="revealPic(4)"></button>
          </div>
          <div class="card" id="card5">
            <button class="square" id="s5" onclick="revealPic(5)"></button>
          </div>
          <div class="card" id="card6">
            <button class="square" id="s6" onclick="revealPic(6)"></button>
          </div>
          <div class="card" id="card7">
            <button class="square" id="s7" onclick="revealPic(7)"></button>
          </div>
          <div class="card" id="card8">
            <button class="square" id="s8" onclick="revealPic(8)"></button>
          </div>
          <div class="card" id="card9">
            <button class="square" id="s9" onclick="revealPic(9)"></button>
          </div>
          <div class="card" id="card10">
            <button class="square" id="s10" onclick="revealPic(10)"></button>
          </div>
          <div class="card" id="card11">
            <button class="square" id="s11" onclick="revealPic(11)"></button>
          </div>
          <div class="card" id="card12">
            <button class="square" id="s12" onclick="revealPic(12)"></button>
          </div>
          <div class="card" id="card13">
            <button class="square" id="s13" onclick="revealPic(13)"></button>
          </div>
          <div class="card" id="card14">
            <button class="square" id="s14" onclick="revealPic(14)"></button>
          </div>
          <div class="card" id="card15">
            <button class="square" id="s15" onclick="revealPic(15)"></button>
          </div>
          <div class="card" id="card16">
            <button class="square" id="s16" onclick="revealPic(16)"></button>
          </div>
        </div>
      </div>
    </div>

    <script>
      let objArr = createObjArr(); // an arrey of 2 square ids and 1 picture id
      givePicToId();
      let opnCardCount = 0;
      let opnCardId1;
      let opnCardId2;
      let mistakes = 0;
      let moves = 0;
      function createObjArr() {
        let rndArr = [];
        let rndPicArr = [];
        let rndCount = 0;
        let rnd1 = 0;
        let rnd2 = 0;
        let rndPicId = 0;
        let funResultArr = [];
        let i = 1;
        for (let i = 0; i < 8; i++) {
          //loop that adds a number of the picture in random order to an array
          while (true) {
            rndPicId = Math.floor(Math.random(1) * 8) + 1;
            if (rndPicArr.find((element) => element == rndPicId) == undefined) {
              rndPicArr.push(rndPicId);
              break;
            }
          }
          while (true) {
            rnd1 = Math.floor(Math.random(1) * 16) + 1;
            if (rndArr.find((j) => j == rnd1) == undefined) {
              rndArr.push(rnd1);
              break;
            }
          }
          while (true) {
            rnd2 = Math.floor(Math.random(1) * 16) + 1;
            if (rndArr.find((i) => i == rnd2) == undefined) {
              rndArr.push(rnd2);
              break;
            }
          }
          funResultArr.push({ id1: rnd1, id2: rnd2, picId: rndPicId });
        }
        console.log(funResultArr);
        return funResultArr;
      }

      function givePicToId() {
        for (let i of objArr) {
          //i = { id1: rnd1, id2: rnd2, picId: rndPicId }
          document.querySelector(
            `#card${i.id1}`
          ).innerHTML += `<img id = "p${i.id1}" class= "card" src="/pictures/${i.picId}.jpg">`;
          document.querySelector(
            `#card${i.id2}`
          ).innerHTML += `<img id = "p${i.id2}" class= "card" src="/pictures/${i.picId}.jpg">`;
          document.querySelector(`#p${i.id1}`).style.display = "none";
          document.querySelector(`#p${i.id2}`).style.display = "none";
        }
      }

      function revealPic(pictureId) {
        opnCardCount++;
        if (opnCardCount == 1) {
          //if only one card open:
          opnCardId1 = pictureId;
          alert("opnCardId1:" + opnCardId1);
          document.querySelector(`#s${pictureId}`).style.display = "none";
          document.querySelector(`#p${pictureId}`).style.display = "block";
        }
        if (opnCardCount == 2) {
          opnCardId2 = pictureId;
          //alert("opnCardId1:" + opnCardId1 + "opnCardId2:" + opnCardId2);
          if (opnCardId1 == opnCardId2) {
            console.log("tha fuck u doin");
            return null;
          }
          document.querySelector(`#s${opnCardId2}`).style.display = "none";
          document.querySelector(`#p${opnCardId2}`).style.display = "block";
          ///check both cards are the same pic
          moves++;
          if (!checkSamePic()) {
            setTimeout(flipSquares, 1000); //flip the squares but wait 1 seconds
          }
          opnCardCount = 0;
        }
      }
      function flipSquares() {
        document.querySelector(`#s${opnCardId1}`).style.display = "block";
        document.querySelector(`#p${opnCardId1}`).style.display = "none";
        document.querySelector(`#s${opnCardId2}`).style.display = "block";
        document.querySelector(`#p${opnCardId2}`).style.display = "none";
      }
      function checkSamePic() {
        for (let i of objArr) {
          if (
            (i.id1 == opnCardId1 && i.id2 == opnCardId2) ||
            (i.id1 == opnCardId2 && i.id2 == opnCardId1)
          ) {
            return true;
          }
        }
        return false;
      }
    </script>
  </body>
</html>
