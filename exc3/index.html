<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body></body>

  <script>
    let board = [];
    let resultsPrompt = "";
    let results = [];
    function Create_Board(num) {
      board = [];
      for (let i = 0; i < num; i++) {
        board.push([]);
        for (let j = 1; j <= num; j++) {
          if (i == 1) {
            board[i].push(j + board.length * i + 1);
          } else {
            board[i].push(j + board.length * i);
          }
        }
      }
    }
    function print_board() {
      for (let i = 0; i < board.length; i++) {
        let row = "";
        for (let j = 0; j < board.length; j++) {
          if (j < board.length - 1) {
            row += board[i][j] + " ┃ ";
          } else {
            row += board[i][j];
          }
        }
        console.log(row);
        if (i < board.length - 1) {
          console.log("━━━".repeat(board.length));
        }
      }
      console.log("");
      console.log("");
    }
    function Is_Win_By_Culomn(culomn_index) {
      let boll = true;
      for (let iR = 0; iR < board.length; iR++) {
        if (iR < board.length - 1) {
          if (board[iR][culomn_index] != board[iR + 1][culomn_index]) {
            return false;
          }
        }
      }
      return true;
    }
    function Is_Win_By_Row(row_index) {
      for (let j = 0; j < board.length; j++) {
        if (
          j < board.length - 1 &&
          board[row_index][j] != board[row_index][j + 1]
        ) {
          return false;
        }
      }
      return true;
    }
    function Is_Win_By_Diagnal_ltr() {
      for (let iR = 0; iR < board.length; iR++) {
        if (iR < board.length - 1) {
          if (board[iR][iR] != board[iR + 1][iR + 1]) {
            return false;
          }
        }
      }
      return true;
    }

    function Is_Win_By_Diagnal_rtl() {
      let iC = board.length - 1;
      for (let iR = 0; iR < board.length; iR++) {
        if (iR < board.length - 1 && iC > 0) {
          if (board[iR][iC] != board[iR + 1][iC - 1]) {
            return false;
          }
        }
        iC--;
      }
      return true;
    }
    function Is_Win_By_Diagnal() {
      if (Is_Win_By_Diagnal_ltr() || Is_Win_By_Diagnal_rtl()) {
        return true;
      }
      return false;
    }
    function Is_Win() {
      if (Is_Win_By_Diagnal()) {
        return true;
      }
      for (let i = 0; i < board.length; i++) {
        if (Is_Win_By_Culomn(i)) {
          return true;
        }
        if (Is_Win_By_Row(i)) {
          return true;
        }
      }
      return false;
    }
    function check_can_play() {
      let counter = 0;
      for (let i = 1; i <= board.length ** 2; i++) {
        if (check_can_place(i)) {
          return true;
        }
      }
      return false;
    }
    function check_can_place(place) {
      for (let i = 0; i < board.length; i++) {
        for (let j = 0; j < board.length; j++) {
          if (board[i][j] == place) {
            return true;
          }
        }
      }
      return false;
    }
    function place_in_board(place, player) {
      if (check_can_place(place)) {
        for (let i = 0; i < board.length; i++) {
          for (let j = 0; j < board.length; j++) {
            if (board[i][j] == place) {
              board[i][j] = player;
              color();
              return true;
            }
          }
        }
      } else {
        return false;
      }
    }
    function getResults() {
      let countX = 0;
      let countO = 0;
      for (let i of results) {
        if (i == "X") {
          countX++;
        } else if (i == "O") {
          countO++;
        }
      }
      resultsPrompt = `results - X: ${countX}, O: ${countO}`;
    }
    function color() {
      for (let j = 0; j < board.length; j++) {
        for (let i = 0; i < board.length; i++) {
          if (board[j][i] == "X") {
            board[j][i] = ("%c X", "color: green;");
          } else if (board[j][i] == "O") {
            board[j][i] = ("%c O", "color:red;");
          }
        }
      }
    }
    function run() {
      let player1 = prompt("enter player1 name: ");
      let player2 = prompt("enter player2 name: ");
      let currentPlayer = player1;
      let game_loop = true;
      while (game_loop) {
        let count = 0;
        let place = "";
        let board_size = prompt("enter board size: ");
        while (true) {
          if (isFinite(board_size)) {
            Create_Board(board_size);
            break;
          } else {
            board_size = prompt("enter valid board size: ");
          }
        }
        let symbol = "X";
        while (check_can_play()) {
          console.clear();
          print_board();
          if (count % 2 == 0) {
            symbol = "X";
            currentPlayer = player1;
          } else {
            symbol = "O";
            currentPlayer = player2;
          }
          place = prompt(`where do u want to put ${symbol}?`);
          while (true) {
            if (check_can_place(place)) {
              place_in_board(place, symbol);
              break;
            } else {
              place = prompt(`enter valid place on board:`);
            }
          }
          if (Is_Win() || !check_can_play()) {
            print_board();
            break;
          }
          count++;
        }
        if (Is_Win()) {
          console.log(`the winner is: ${currentPlayer}!`);
          results.push(currentPlayer);
        } else {
          console.log(`it's a tie`);
        }
        getResults();
        console.log(resultsPrompt);
        let contin = prompt("do you want to continue playing? y/n");
        while (true) {
          if (contin == "n") {
            game_loop = false;
            break;
          } else if (contin == "y") {
            break;
          } else {
            contin = prompt("enter valid prompt! y/n");
          }
        }
      }
    }
    run();
  </script>
</html>
